<?xml version="1.0" encoding="utf-8" ?>
<Imaginet>
	<Unit name="Imaginet.Units.Math.Reshape">
		<DisplayName>Reshape</DisplayName>
		<DisplayPath>/Math/Slicing and Shaping</DisplayPath>

		<Description>
			<Header>Description</Header>
			Reorganize tensor data into a different dimensional structure without changing the underlying data or total number of elements.
			
			This unit reinterprets the linear sequence of tensor elements as having a different shape. The total number of elements must remain constant between input and output shapes. Reshaping is a metadata operation that changes how the data is indexed and accessed but does not move or modify the actual values.
			
			Common use cases include converting flat preprocessor inputs into multi-dimensional structures, preparing data for operations that expect specific tensor ranks, or reorganizing data to group related features together.

			<Header>Usage</Header>
			Use the Reshape unit to reorganize flat sensor data into structured dimensions. For example, a flat input of 6 values containing 3 accelerometer readings followed by 3 gyroscope readings can be reshaped to [2,3] to separate the two sensor types into distinct rows.
		</Description>

		<Parameters>
			<InputSocket name="input" text="Input" description="Input tensor to be reshaped. Any data type and shape supported." />

			<ShapeOption name="shape" text="Shape" default="[3]" description="Target shape for the output tensor. Must contain the same total number of elements as the input shape." />

			<ReturnSocket name="output" text="Output" description="Output tensor with the specified shape. Contains the same data as the input, reorganized into the new dimensional structure." />


			<StringOption
				name="axis_names"
				text="Axis Names (Deprecated)"
				description="Deprecated. Use the Labels unit instead. Comma-separated list of axis names matching the tensor rank." />

			<StringOption
				name="axis_labels"
				text="Axis Labels (Deprecated)"
				description="Deprecated. Use the Labels unit instead. Axis labels with one parentheses group per dimension." />


		</Parameters>
		
		<Contracts>
			<Assert 
				test="input == null || input.shape.flat == shape.flat" 
				error="Input shape ({input.shape}) and output shape ({shape}) must have the same number of elements."/>
		</Contracts>
				
		<Implementations>
			<Factory
				assembly="Imaginet.Units.Math"
				class="Imaginet.Units.Math.Reshape.Reshape"
				call="Build(input, shape, axis_names, axis_labels, output)" />
		</Implementations>

	</Unit>
</Imaginet>